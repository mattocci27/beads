<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Trait | dummy_data.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Trait | dummy_data.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Trait | dummy_data.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Multivariate Statistics</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#trait"><i class="fa fa-check"></i><b>1</b> Trait</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#simple-covariance"><i class="fa fa-check"></i><b>1.1</b> Simple Covariance</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#mass-artifact"><i class="fa fa-check"></i><b>1.2</b> Mass artifact</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path=""><a href="#phylo"><i class="fa fa-check"></i><b>2</b> Phylo</a></li>
<li class="chapter" data-level="3" data-path=""><a href="#save"><i class="fa fa-check"></i><b>3</b> save</a></li>
<li class="chapter" data-level="4" data-path=""><a href="#env"><i class="fa fa-check"></i><b>4</b> env</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(picante)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(factoextra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">library</span>(mvtnorm)</span></code></pre></div>
<div id="trait" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Trait</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>t &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/trait.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Species = col_character(),
##   SLA = col_double(),
##   RootTissueDens = col_double(),
##   LeafArea = col_double(),
##   LeafThickness = col_double(),
##   LeafTissueDens = col_double(),
##   RootDiam = col_double()
## )</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>sp &lt;-<span class="st"> </span>t<span class="op">$</span>Species</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>t2 &lt;-<span class="st"> </span>t <span class="op">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">names_to =</span> <span class="st">&quot;trait&quot;</span>) </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="kw">ggplot</span>(t2, <span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>trait, <span class="dt">scale =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="dummy_data_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">ggplot</span>(t2, <span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>trait, <span class="dt">scale =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="dummy_data_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>pca_res &lt;-<span class="st"> </span><span class="kw">prcomp</span>(t[,<span class="op">-</span><span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span>log, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">fviz_pca_biplot</span>(pca_res, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>                <span class="dt">axis =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>                <span class="dt">axes.linetype =</span> <span class="st">&quot;dotted&quot;</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>                <span class="dt">col.var =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>                <span class="dt">alpha.var =</span> <span class="fl">0.9</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>                <span class="dt">pointsize =</span> <span class="fl">2.5</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>                <span class="dt">alpha.ind =</span> <span class="fl">0.9</span>, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>                <span class="dt">geom.ind =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a>                <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;#7570b3&quot;</span>, <span class="st">&quot;#1b9e77&quot;</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a>                <span class="dt">addEllipses =</span> <span class="ot">TRUE</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a>                <span class="dt">ellipse.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>                <span class="dt">title =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a>                <span class="dt">arrowsize =</span> <span class="fl">0.5</span>, </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a>                <span class="co">#labelsize = 2, </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a>                <span class="dt">label =</span> <span class="st">&quot;all&quot;</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a>                <span class="dt">mean.point =</span> <span class="ot">FALSE</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a>                <span class="dt">repel =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="dummy_data_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<div id="simple-covariance" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Simple Covariance</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/nature02403-s2.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X22&#39; [22], &#39;X23&#39; [23], &#39;X24&#39; [24], &#39;X25&#39; [25], &#39;X26&#39; [26], &#39;X27&#39; [27],
## &#39;X28&#39; [28]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   Dataset = col_character(),
##   BIOME = col_character(),
##   Species = col_character(),
##   GF = col_character(),
##   `Decid/E&#39;green` = col_character(),
##   `Needle/Broad lf` = col_character(),
##   C3C4 = col_character(),
##   `N2-fixer` = col_character(),
##   X22 = col_logical(),
##   X23 = col_logical(),
##   X24 = col_logical(),
##   X25 = col_logical(),
##   X26 = col_logical(),
##   X27 = col_logical(),
##   X28 = col_logical()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">sp =</span> d[ , <span class="st">&quot;Species&quot;</span>] <span class="op">%&gt;%</span><span class="st"> </span>unlist,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>         <span class="dt">logLL =</span> d<span class="op">$</span><span class="st">`</span><span class="dt">log LL</span><span class="st">`</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>         <span class="dt">logLMA =</span> d<span class="op">$</span><span class="st">`</span><span class="dt">log LMA</span><span class="st">`</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>         <span class="dt">logAmass =</span> d<span class="op">$</span><span class="st">`</span><span class="dt">log Amass</span><span class="st">`</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>         <span class="dt">logNmass =</span> d<span class="op">$</span><span class="st">`</span><span class="dt">log Nmass</span><span class="st">`</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>         <span class="dt">logPmass =</span> d<span class="op">$</span><span class="st">`</span><span class="dt">log Pmass</span><span class="st">`</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>         <span class="dt">logRmass =</span> d<span class="op">$</span><span class="st">`</span><span class="dt">log Rdmass</span><span class="st">`</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>tm &lt;-<span class="st"> </span>data[,<span class="op">-</span><span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a><span class="st">  </span>drop_na <span class="op">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a><span class="st">  </span>as.matrix</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>means &lt;-<span class="st"> </span><span class="kw">apply</span>(tm, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)})</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a>sds &lt;-<span class="st"> </span><span class="kw">apply</span>(tm, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="kw">sd</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)})</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a>tm2 &lt;-<span class="st"> </span><span class="kw">scale</span>(tm)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a>S &lt;-<span class="st"> </span><span class="kw">t</span>(tm2) <span class="op">%*%</span><span class="st"> </span>tm2 <span class="op">/</span><span class="st"> </span><span class="kw">ncol</span>(tm <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a>S2 &lt;-<span class="st"> </span><span class="kw">cov2cor</span>(S)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a>S3 &lt;-<span class="st"> </span>S2</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sds)) S3[i, ] &lt;-<span class="st"> </span>S3[i, ] <span class="op">*</span><span class="st"> </span>sds[i]</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sds)) S3[, i] &lt;-<span class="st"> </span>S3[, i] <span class="op">*</span><span class="st"> </span>sds[i]</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a>trait &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="kw">rmvnorm</span>(<span class="kw">length</span>(sp), means, S3) <span class="op">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a><span class="st">  </span>as_tibble </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a>trait <span class="op">%&gt;%</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">names_to =</span> <span class="st">&quot;trait&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>trait, <span class="dt">scale =</span> <span class="st">&quot;free&quot;</span>) </span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="dummy_data_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>trait <span class="op">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">names_to =</span> <span class="st">&quot;trait&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>trait, <span class="dt">scale =</span> <span class="st">&quot;free&quot;</span>) </span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="dummy_data_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>pca_res &lt;-<span class="st"> </span><span class="kw">prcomp</span>(trait <span class="op">%&gt;%</span><span class="st"> </span>log, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="kw">fviz_pca_biplot</span>(pca_res, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>                <span class="dt">axis =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>                <span class="dt">axes.linetype =</span> <span class="st">&quot;dotted&quot;</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>                <span class="dt">col.var =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>                <span class="dt">alpha.var =</span> <span class="fl">0.9</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>                <span class="dt">pointsize =</span> <span class="fl">2.5</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>                <span class="dt">alpha.ind =</span> <span class="fl">0.9</span>, </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a>                <span class="dt">geom.ind =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>                <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;#7570b3&quot;</span>, <span class="st">&quot;#1b9e77&quot;</span>),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a>                <span class="dt">addEllipses =</span> <span class="ot">TRUE</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a>                <span class="dt">ellipse.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a>                <span class="dt">title =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a>                <span class="dt">arrowsize =</span> <span class="fl">0.5</span>, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a>                <span class="co">#labelsize = 2, </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a>                <span class="dt">label =</span> <span class="st">&quot;all&quot;</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true"></a>                <span class="dt">mean.point =</span> <span class="ot">FALSE</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true"></a>                <span class="dt">repel =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="dummy_data_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
</div>
<div id="mass-artifact" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Mass artifact</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>LMA &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>data<span class="op">$</span>logLMA <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="st">  </span>na.omit <span class="op">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="st">  </span>as.numeric</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>LL &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(LMA), </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>             <span class="fl">-1.3</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.1</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(LMA),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a>             <span class="kw">sd</span>(data<span class="op">$</span>logLL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>data <span class="op">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">logLMA_inv =</span> <span class="op">-</span>logLMA) <span class="op">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a><span class="st">  </span><span class="kw">lm</span>(logAmass <span class="op">~</span><span class="st"> </span>logLMA_inv, .)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logAmass ~ logLMA_inv, data = .)
## 
## Coefficients:
## (Intercept)   logLMA_inv  
##      3.8752       0.9384</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a>Amass &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(LMA),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>               <span class="kw">log</span>(<span class="dv">11642</span>  <span class="op">/</span><span class="st"> </span>LMA) <span class="op">-</span><span class="st"> </span><span class="fl">0.55</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>               <span class="fl">0.55</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a>Rmass &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(LMA),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>               <span class="kw">log</span>(<span class="dv">1402</span>  <span class="op">/</span><span class="st"> </span>LMA) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>               <span class="fl">0.5</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>Nmass &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(LMA),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a>               <span class="kw">log</span>(<span class="fl">1.94</span>  <span class="op">/</span><span class="st"> </span>LMA) <span class="op">-</span><span class="st"> </span><span class="fl">0.46</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a>               <span class="fl">0.46</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a>Pmass &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(LMA),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>               <span class="kw">log</span>(<span class="fl">0.1305</span>  <span class="op">/</span><span class="st"> </span>LMA) <span class="op">-</span><span class="st"> </span><span class="fl">0.6</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true"></a>               <span class="fl">0.6</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true"></a>WD &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(LMA), </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true"></a>             <span class="kw">log</span>(<span class="fl">0.5</span>) <span class="op">-</span><span class="st"> </span><span class="fl">0.2</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="fl">2.</span>, <span class="fl">0.2</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true"></a>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true"></a>SM &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(LMA), </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true"></a>             <span class="kw">log</span>(<span class="fl">2.3</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="fl">2.</span>, <span class="dv">1</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true"></a>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true"></a>data2 &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true"></a> LMA,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true"></a> LL,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true"></a> Amass,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true"></a> Rmass,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true"></a> <span class="dt">Nmass =</span> Nmass <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true"></a> <span class="dt">Pmass =</span> Pmass <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true"></a> WD, </span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true"></a> SM</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true"></a>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true"></a>dummy_trait &lt;-<span class="st"> </span>data2 <span class="op">%&gt;%</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="kw">length</span>(sp))</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true"></a>pca_res &lt;-<span class="st"> </span><span class="kw">prcomp</span>(data2 <span class="op">%&gt;%</span><span class="st"> </span>log, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true"></a></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true"></a><span class="kw">fviz_pca_biplot</span>(pca_res, </span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true"></a>                <span class="dt">axis =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true"></a>                <span class="dt">axes.linetype =</span> <span class="st">&quot;dotted&quot;</span>, </span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true"></a>                <span class="dt">col.var =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true"></a>                <span class="dt">alpha.var =</span> <span class="fl">0.9</span>,</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true"></a>                <span class="dt">pointsize =</span> <span class="fl">2.5</span>, </span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true"></a>                <span class="dt">alpha.ind =</span> <span class="fl">0.1</span>, </span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true"></a>                <span class="dt">geom.ind =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true"></a>                <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;#7570b3&quot;</span>, <span class="st">&quot;#1b9e77&quot;</span>),</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true"></a>                <span class="dt">addEllipses =</span> <span class="ot">TRUE</span>,</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true"></a>                <span class="dt">ellipse.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true"></a>                <span class="dt">title =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true"></a>                <span class="dt">arrowsize =</span> <span class="fl">0.5</span>, </span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true"></a>                <span class="co">#labelsize = 2, </span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true"></a>                <span class="dt">label =</span> <span class="st">&quot;all&quot;</span>,</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true"></a>                <span class="dt">mean.point =</span> <span class="ot">FALSE</span>,</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true"></a>                <span class="dt">repel =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="dummy_data_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
</div>
<div id="phylo" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Phylo</h1>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a>tr &lt;-<span class="st"> </span><span class="kw">read.tree</span>(<span class="st">&quot;data/qjzad.tre&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>tr_dist &lt;-<span class="st"> </span><span class="kw">vcv</span>(tr) <span class="op">%&gt;%</span><span class="st"> </span>cov2cor</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>phy_tr &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(<span class="dv">2</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">ncol</span>(tr_dist)), tr_dist)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>tmp &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">tmp =</span> phy_tr[<span class="dv">1</span>, ], <span class="dt">sp =</span> <span class="kw">colnames</span>(tr_dist)) <span class="op">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(tmp)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a>dummy_trait2 &lt;-<span class="st"> </span>dummy_trait <span class="op">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(LMA)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a>dummy_trait3 &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(tmp, dummy_trait2)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a>dummy_trait3  <span class="op">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(.)</span></code></pre></div>
<p><div id="htmlwidget-01d52c5e05c9ea69cff3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-01d52c5e05c9ea69cff3">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77"],[-1.61949221597004,-1.28875182013813,-1.1726531418554,-1.15165132769575,-1.04534223412722,-1.01405928250022,-0.889180496570353,-0.842621373969743,-0.836101384398898,-0.775781064942396,-0.764094633105566,-0.758895873267427,-0.741167031298972,-0.730359141327033,-0.615500061408109,-0.595927617673186,-0.584868513241494,-0.529742562535452,-0.518985121721834,-0.483809860896983,-0.472824866327879,-0.446465508445635,-0.437991400283261,-0.420617690501938,-0.402062020728421,-0.358872012403722,-0.343852973565971,-0.339510678643429,-0.301186528682188,-0.251125385780945,-0.217613948716592,-0.198445995892684,-0.177676349029087,-0.168804510189297,-0.152335290087309,-0.0410572860648369,-0.0296588128130648,-0.0217206980594915,-0.0127027909565008,0.0296262129052391,0.0996100183432135,0.125626521076616,0.159901298132681,0.179621196380643,0.183370942241806,0.245504107876845,0.247350225206687,0.259932603078308,0.32353050964886,0.335168900774306,0.377712011962857,0.381612552758913,0.422869425987692,0.448624382310982,0.449043186003705,0.45194656134138,0.457770163870292,0.512794011179566,0.585824602014983,0.601198201606873,0.722604424838111,0.862154326712621,0.887204582151942,0.902583735158405,0.913257286783038,0.985385317131876,0.990754432709227,1.07432133591928,1.12877604944167,1.20243045532434,1.26400161523592,1.27591512389515,1.61295971156557,1.69340788482619,1.79925269004124,1.85728281596969,1.8796643111774],["Schefflera_fengii","Schefflera_shweliensis","Ilex_corallina","Beilschmiedia_robusta","Itoa_orientalis","Acer_campbellii","Skimmia_arborescens","Sterculia_nobilis","Litsea_chunii","Ilex_manneiensis","Rhus_sylvestris","Symplocos_ramosissima","Leucosceptrum_canum","Glochidion_a","Camellia_forrestii","Litsea_a","Machilus_salicina","Eurya_trichocarpa","Symplocos_anomala","Exbucklandia_populnea","Litsea_elongata","Castanopsis_echidnocarpa","Anneslea_fragrans","Actinodaphne_forrestii","Claoxylon_khasianum","Neolitsea_polycarpa","Machilus_yunnanensis","Eurya_quinquelocularis","Symplocos_grandis","Symplocos_sumuntia","Lindera_caudata","Olea_rosea","Lindera_thomsonii","Ternstroemia_gymnanthera","Castanopsis_wattii","Machilus_gamblei","Eurya_paratetragonoclada","Schima_noronhae","Stewartia_pteropetiolata","Camellia_assamica","Melia_toosendan","Lithocarpus_xylocarpus","Lithocarpus_confinis","Neolitsea_chuii","Ficus_racemosa","Meliosma_arnottiana","Camellia_Pitardii","Alnus_nepalensis","Mahonia_duclouxiana","Betula_alnoides","Meliosma_kirkii","Eriobotrya_tengyuehensis","Schima_argentea","Myrsine_semiserrata","Michelia_floribunda","Camellia_yunnanensis","Eriobotrya_bengalensis","Cyclobalanopsis_stewardiana","Lithocarpus_dealbatus","Lithocarpus_crassifolius","Ficus_henryi","Laurocerasus_undulata","Osbeckia_mepalensis","Lithocarpus_henryi","Lithocarpus_truncatus","Stewartia_yunnanensis","Vaccinium_duclouxii","Lithocarpus_hancei","Rhododendron_leptothrium","Illicium_macranthum","Saurauia_napaulensis","Craibiodendron_yunnanense","Padus_napaulensis","Rhododendron_irroratum","Rhododendron_decorum","Manglietia_insignis","Ficus_heteromorpha"],[17.38,22.91,33.88,37.15,38.9,39.81,40.74,43.65,45.71,46.77,47.86,48.98,48.98,50.12,51.29,52.48,53.7,56.23,58.88,58.88,61.66,66.07,66.07,69.18,69.18,70.79,70.79,74.13,74.13,77.62,83.18,85.11,87.1,87.1,89.13,91.2,93.33,93.33,97.72,100,102.33,102.33,102.33,104.71,107.15,109.65,109.65,114.82,114.82,114.82,117.49,128.82,131.83,134.9,138.04,141.25,158.49,158.49,162.18,165.96,177.83,177.83,186.21,194.98,208.93,213.8,251.19,281.84,281.84,288.4,309.03,316.23,354.81,416.87,446.68,501.19,602.56],[5.38,13.66,11.39,21.88,14.4,7.08,11.28,12.54,24.45,16.15,22.01,26.3,11.56,12.4,11.34,13.09,21.35,20.35,37.55,27.2,70.05,13.49,26.93,12.52,21.39,28.34,28.92,24.52,34.07,47.86,40.3,33.53,40.32,39.94,47.13,41.89,81.85,89.84,21.33,24.51,35.39,69.58,22.98,65.31,22.07,17.59,50.34,55.17,48.12,33.07,61.07,73.88,83.97,48.89,54.17,131.73,32.31,71.45,73.87,108.44,148.11,96.8,86.53,68.96,103.23,100.82,106.89,104.3,109.86,115.18,146.83,72.98,124.41,267.95,184.22,187.96,250.94],[475.01,258.88,180.52,305.65,183.31,985.05,455.29,264.45,135.64,313.61,137.68,265.32,315.8,470.59,301.56,77.3,153.06,183.25,238.62,293.43,136.92,89.25,174.55,149.36,88.87,130.14,104.55,103.75,56.15,57.25,91.6,82.8,241.4,139.45,156.76,99.27,91.38,66.24,123.21,97.93,156.16,77.47,68.8,181.2,101.55,101,130.34,76.81,257.52,85.97,54.83,96.06,86.72,166.41,38.44,89.32,33.32,40.24,36.67,51.58,83.33,45.55,99.93,20.31,23.23,27.89,31.84,18.74,56.42,26.44,18.89,27.86,24.94,23.21,24.06,22.27,11.35],[67.58,55.8,66.95,34.01,11.77,54.71,29.7,35.62,57.32,24.62,25.01,27.88,29.82,49.34,17.71,5.47,25.22,42.1,26.62,18.3,13.78,18.94,40.59,8.79,23.18,19.04,14.7,4.58,29.94,27.87,20.12,16.65,20.45,9.2,23.44,14.91,23.8,15.65,9.14,14.38,3.48,21.3,21.3,9.93,4.87,9.4,6.03,7.56,16.19,16.4,11.48,8.15,7.18,4.96,7.36,8.24,3.84,6.19,12.12,11.41,13.94,8.25,17.46,12.9,4.65,7.23,7.22,4.69,3.73,2.21,9.57,2.03,9.25,4.68,2.18,1.29,3.79],[22.69,14.16,5.19,5.78,5.77,6.56,5.14,3,4.28,5.78,4.88,5.69,5.71,1.86,1.4,4.26,5.94,5.96,4.22,2.94,1.53,1.1,4.32,1.51,4.56,4.23,1.27,1.19,1.5,0.97,1.04,2.85,1.87,6.43,2.35,3.98,0.84,1.28,1.08,2.27,0.95,0.85,0.98,1.63,1.4,1.36,2.22,1.65,1.1,2.33,2.37,1.27,0.62,0.63,1.58,0.74,3.43,0.47,3.89,1.11,2.38,1.77,0.34,1.28,0.79,0.96,1.31,0.44,0.37,0.75,0.32,0.61,0.32,0.3,0.38,0.65,0.33],[0.48,0.52,0.74,0.26,0.15,0.42,0.23,0.46,0.42,0.18,0.16,0.19,0.31,0.13,0.14,0.13,0.16,0.14,0.42,0.13,0.21,0.15,0.13,0.16,0.22,0.24,0.44,0.11,0.09,0.05,0.05,0.05,0.05,0.08,0.26,0.16,0.06,0.09,0.16,0.4,0.18,0.05,0.11,0.12,0.09,0.13,0.07,0.1,0.11,0.09,0.05,0.04,0.06,0.03,0.02,0.05,0.08,0.01,0.1,0.07,0.06,0.13,0.08,0.02,0.06,0.08,0.03,0.03,0.08,0.03,0.03,0.03,0.06,0.14,0.01,0.02,0.02],[0.5,0.46,0.65,0.47,0.35,0.46,0.45,0.47,0.68,0.49,0.52,0.48,0.51,0.64,0.49,0.66,0.86,0.58,0.42,0.53,0.41,0.76,0.54,0.48,0.53,0.45,0.59,0.31,0.46,0.59,0.51,0.45,0.53,0.51,0.41,0.48,0.63,0.44,0.37,0.42,0.43,0.49,0.46,0.43,0.58,0.48,0.43,0.35,0.51,0.45,0.6,0.39,0.53,0.6,0.54,0.53,0.48,0.33,0.69,0.53,0.34,0.58,0.55,0.53,0.35,0.45,0.53,0.42,0.64,0.4,0.38,0.44,0.54,0.62,0.61,0.45,0.44],[0.92,0.06,1.55,2.16,4.39,0.39,2.05,1.87,2.18,5.19,7.98,1.55,0.55,5.19,2.43,0.82,0.13,0.85,0.83,4.52,0.58,4.84,1.25,1.35,0.29,1.92,1.08,0.5,5.54,0.14,3.82,2.86,0.48,0.36,1.3,4.09,2.04,1.56,0.96,0.55,0.46,2.73,0.38,0.18,0.98,1.07,5.3,1.21,0.33,0.17,1.55,3.02,3,0.2,1.86,6.95,1.16,0.45,0.49,1.59,2.87,2.01,4.74,4.51,2.79,0.74,0.42,0.42,3.22,0.97,3.07,2.35,0.37,1.07,1.61,0.95,2.56]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>tmp<\/th>\n      <th>sp<\/th>\n      <th>LMA<\/th>\n      <th>LL<\/th>\n      <th>Amass<\/th>\n      <th>Rmass<\/th>\n      <th>Nmass<\/th>\n      <th>Pmass<\/th>\n      <th>WD<\/th>\n      <th>SM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
# Check k signal</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>tr2 &lt;-<span class="st"> </span><span class="kw">chronos</span>(tr, <span class="dt">lambda=</span><span class="dv">0</span>)  </span></code></pre></div>
<pre><code>## 
## Setting initial dates...
## Fitting in progress... get a first set of estimates
##          (Penalised) log-lik = -349.5103 
## Optimising rates... dates... -349.5103 
## 
## log-Lik = -349.5103 
## PHIIC = 1049.02</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>tr3 &lt;-<span class="st"> </span><span class="kw">multi2di</span>(tr2, <span class="dt">random=</span><span class="ot">TRUE</span>) </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="co">#tr$edge.length &lt;- tr$edge.length + rnorm(length(tr$edge.length), 0, 0.01)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a>physig_tb &lt;-<span class="st"> </span><span class="kw">tibble</span>()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a>  x &lt;-<span class="st"> </span>dummy_trait3[,i] <span class="op">%&gt;%</span><span class="st"> </span>unlist</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a>  <span class="kw">names</span>(x) &lt;-<span class="st"> </span>dummy_trait3<span class="op">$</span>sp</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a>  physig_tb  &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(physig_tb, <span class="kw">phylosignal</span>(x[tr3<span class="op">$</span>tip.label], tr3))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a>}</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a>physig_tb2 &lt;-<span class="st"> </span>physig_tb <span class="op">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">trait =</span> <span class="kw">names</span>(dummy_trait3)[<span class="dv">3</span><span class="op">:</span><span class="dv">10</span>])</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a>physig_tb2</span></code></pre></div>
<pre><code>## # A tibble: 8 x 6
##       K PIC.variance.obs PIC.variance.rnd.mean PIC.variance.P PIC.variance.Z trait
##   &lt;dbl&gt;            &lt;dbl&gt;                 &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;
## 1 0.357       48063.                92324.              0.003         -2.29  LMA  
## 2 0.231       15780.                20447.              0.129         -1.15  LL   
## 3 0.274       96175.               148300.              0.105         -1.15  Amass
## 4 0.345         907.                 1652.              0.001         -2.58  Rmass
## 5 0.457          29.7                  74.1             0.002         -1.73  Nmass
## 6 0.340           0.0770                0.142           0.003         -2.30  Pmass
## 7 0.171           0.0748                0.0711          0.673          0.330 WD   
## 8 0.191          21.1                  21.7             0.448         -0.162 SM</code></pre>
</div>
<div id="save" class="section level1" number="3">
<h1><span class="header-section-number">3</span> save</h1>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>dummy_trait3 <span class="op">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>tmp) <span class="op">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(sp) <span class="op">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">write_csv</span>(., <span class="st">&quot;./data/dummy_trait.csv&quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>tr3 <span class="op">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">write.tree</span>(., <span class="st">&quot;./data/dummy_tree.newick&quot;</span>)</span></code></pre></div>
</div>
<div id="env" class="section level1" number="4">
<h1><span class="header-section-number">4</span> env</h1>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>devtools<span class="op">::</span><span class="kw">session_info</span>()</span></code></pre></div>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.0.2 (2020-06-22)
##  os       Manjaro Linux               
##  system   x86_64, linux-gnu           
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  ctype    en_US.UTF-8                 
##  tz       Asia/Shanghai               
##  date     2020-11-01                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
##  package           * version date       lib source        
##  abind               1.4-5   2016-07-21 [1] CRAN (R 4.0.0)
##  ape               * 5.4-1   2020-08-13 [1] CRAN (R 4.0.2)
##  assertthat          0.2.1   2019-03-21 [1] CRAN (R 4.0.0)
##  backports           1.1.10  2020-09-15 [1] CRAN (R 4.0.2)
##  blob                1.2.1   2020-01-20 [1] CRAN (R 4.0.0)
##  bookdown            0.20    2020-06-23 [1] CRAN (R 4.0.2)
##  broom               0.7.0   2020-07-09 [1] CRAN (R 4.0.2)
##  callr               3.4.4   2020-09-07 [1] CRAN (R 4.0.2)
##  car                 3.0-9   2020-08-11 [1] CRAN (R 4.0.2)
##  carData             3.0-4   2020-05-22 [1] CRAN (R 4.0.2)
##  cellranger          1.1.0   2016-07-27 [1] CRAN (R 4.0.0)
##  cli                 2.0.2   2020-02-28 [1] CRAN (R 4.0.0)
##  cluster             2.1.0   2019-06-19 [1] CRAN (R 4.0.0)
##  colorspace          1.4-1   2019-03-18 [1] CRAN (R 4.0.0)
##  crayon              1.3.4   2017-09-16 [1] CRAN (R 4.0.0)
##  crosstalk           1.1.0.1 2020-03-13 [1] CRAN (R 4.0.0)
##  curl                4.3     2019-12-02 [1] CRAN (R 4.0.0)
##  data.table          1.13.0  2020-07-24 [1] CRAN (R 4.0.2)
##  DBI                 1.1.0   2019-12-15 [1] CRAN (R 4.0.0)
##  dbplyr              1.4.4   2020-05-27 [1] CRAN (R 4.0.2)
##  desc                1.2.0   2018-05-01 [1] CRAN (R 4.0.0)
##  devtools            2.3.2   2020-09-18 [1] CRAN (R 4.0.2)
##  digest              0.6.25  2020-02-23 [1] CRAN (R 4.0.0)
##  DistributionUtils   0.6-0   2018-11-27 [1] CRAN (R 4.0.0)
##  dplyr             * 1.0.2   2020-08-18 [1] CRAN (R 4.0.2)
##  DT                  0.15    2020-08-05 [1] CRAN (R 4.0.2)
##  ellipsis            0.3.1   2020-05-15 [1] CRAN (R 4.0.2)
##  evaluate            0.14    2019-05-28 [1] CRAN (R 4.0.0)
##  factoextra        * 1.0.7   2020-04-01 [1] CRAN (R 4.0.0)
##  fansi               0.4.1   2020-01-08 [1] CRAN (R 4.0.0)
##  farver              2.0.3   2020-01-16 [1] CRAN (R 4.0.0)
##  forcats           * 0.5.0   2020-03-01 [1] CRAN (R 4.0.0)
##  foreign             0.8-80  2020-05-24 [1] CRAN (R 4.0.2)
##  fs                  1.5.0   2020-07-31 [1] CRAN (R 4.0.2)
##  generics            0.0.2   2018-11-29 [1] CRAN (R 4.0.0)
##  ggplot2           * 3.3.2   2020-06-19 [1] CRAN (R 4.0.2)
##  ggpubr              0.4.0   2020-06-27 [1] CRAN (R 4.0.2)
##  ggrepel             0.8.2   2020-03-08 [1] CRAN (R 4.0.0)
##  ggsignif            0.6.0   2019-08-08 [1] CRAN (R 4.0.0)
##  glue                1.4.1   2020-05-13 [1] CRAN (R 4.0.2)
##  gtable              0.3.0   2019-03-25 [1] CRAN (R 4.0.0)
##  haven               2.3.1   2020-06-01 [1] CRAN (R 4.0.2)
##  hms                 0.5.3   2020-01-08 [1] CRAN (R 4.0.0)
##  htmltools           0.5.0   2020-06-16 [1] CRAN (R 4.0.2)
##  htmlwidgets         1.5.1   2019-10-08 [1] CRAN (R 4.0.0)
##  httr                1.4.2   2020-07-20 [1] CRAN (R 4.0.2)
##  jsonlite            1.7.0   2020-06-25 [1] CRAN (R 4.0.2)
##  kernlab             0.9-29  2019-11-12 [1] CRAN (R 4.0.0)
##  knitr               1.29    2020-06-23 [1] CRAN (R 4.0.2)
##  labeling            0.3     2014-08-23 [1] CRAN (R 4.0.0)
##  lattice           * 0.20-41 2020-04-02 [2] CRAN (R 4.0.2)
##  lifecycle           0.2.0   2020-03-06 [1] CRAN (R 4.0.0)
##  lubridate           1.7.9   2020-06-08 [1] CRAN (R 4.0.2)
##  magrittr            1.5     2014-11-22 [1] CRAN (R 4.0.0)
##  MASS                7.3-53  2020-09-09 [1] CRAN (R 4.0.2)
##  Matrix              1.2-18  2019-11-27 [1] CRAN (R 4.0.2)
##  memoise             1.1.0   2017-04-21 [1] CRAN (R 4.0.0)
##  mgcv                1.8-33  2020-08-27 [1] CRAN (R 4.0.2)
##  mixtools            1.2.0   2020-02-07 [1] CRAN (R 4.0.0)
##  modelr              0.1.8   2020-05-19 [1] CRAN (R 4.0.2)
##  munsell             0.5.0   2018-06-12 [1] CRAN (R 4.0.0)
##  mvtnorm           * 1.1-1   2020-06-09 [1] CRAN (R 4.0.2)
##  nlme              * 3.1-148 2020-05-24 [2] CRAN (R 4.0.2)
##  openxlsx            4.2.2   2020-09-17 [1] CRAN (R 4.0.2)
##  permute           * 0.9-5   2019-03-12 [1] CRAN (R 4.0.0)
##  picante           * 1.8.2   2020-06-10 [1] CRAN (R 4.0.2)
##  pillar              1.4.6   2020-07-10 [1] CRAN (R 4.0.2)
##  pkgbuild            1.1.0   2020-07-13 [1] CRAN (R 4.0.2)
##  pkgconfig           2.0.3   2019-09-22 [1] CRAN (R 4.0.0)
##  pkgload             1.1.0   2020-05-29 [1] CRAN (R 4.0.2)
##  poilog            * 0.4     2020-04-27 [1] local         
##  prettyunits         1.1.1   2020-01-24 [1] CRAN (R 4.0.0)
##  processx            3.4.4   2020-09-03 [1] CRAN (R 4.0.2)
##  ps                  1.3.4   2020-08-11 [1] CRAN (R 4.0.2)
##  purrr             * 0.3.4   2020-04-17 [1] CRAN (R 4.0.0)
##  R6                  2.4.1   2019-11-12 [1] CRAN (R 4.0.0)
##  Rcpp                1.0.5   2020-07-06 [1] CRAN (R 4.0.2)
##  readr             * 1.3.1   2018-12-21 [1] CRAN (R 4.0.0)
##  readxl              1.3.1   2019-03-13 [1] CRAN (R 4.0.0)
##  remotes             2.2.0   2020-07-21 [1] CRAN (R 4.0.2)
##  reprex              0.3.0   2019-05-16 [1] CRAN (R 4.0.0)
##  rio                 0.5.16  2018-11-26 [1] CRAN (R 4.0.0)
##  rlang               0.4.7   2020-07-09 [1] CRAN (R 4.0.2)
##  rmarkdown         * 2.3     2020-06-18 [1] CRAN (R 4.0.2)
##  rprojroot           1.3-2   2018-01-03 [1] CRAN (R 4.0.0)
##  rstatix             0.6.0   2020-06-18 [1] CRAN (R 4.0.2)
##  rstudioapi          0.11    2020-02-07 [1] CRAN (R 4.0.0)
##  rvest               0.3.6   2020-07-25 [1] CRAN (R 4.0.2)
##  scales              1.1.1   2020-05-11 [1] CRAN (R 4.0.2)
##  segmented           1.2-0   2020-06-23 [1] CRAN (R 4.0.2)
##  sessioninfo         1.1.1   2018-11-05 [1] CRAN (R 4.0.0)
##  stringi             1.4.6   2020-02-17 [1] CRAN (R 4.0.0)
##  stringr           * 1.4.0   2019-02-10 [1] CRAN (R 4.0.0)
##  survival            3.2-3   2020-06-13 [1] CRAN (R 4.0.2)
##  testthat            2.3.2   2020-03-02 [1] CRAN (R 4.0.0)
##  tibble            * 3.0.3   2020-07-10 [1] CRAN (R 4.0.2)
##  tidyr             * 1.1.1   2020-07-31 [1] CRAN (R 4.0.2)
##  tidyselect          1.1.0   2020-05-11 [1] CRAN (R 4.0.2)
##  tidyverse         * 1.3.0   2019-11-21 [1] CRAN (R 4.0.0)
##  usethis             1.6.3   2020-09-17 [1] CRAN (R 4.0.2)
##  utf8                1.1.4   2018-05-24 [1] CRAN (R 4.0.0)
##  vctrs               0.3.2   2020-07-15 [1] CRAN (R 4.0.2)
##  vegan             * 2.5-6   2019-09-01 [1] CRAN (R 4.0.0)
##  withr               2.3.0   2020-09-22 [1] CRAN (R 4.0.2)
##  xfun                0.16    2020-07-24 [1] CRAN (R 4.0.2)
##  xml2                1.3.2   2020-04-23 [1] CRAN (R 4.0.0)
##  yaml                2.2.1   2020-02-01 [1] CRAN (R 4.0.0)
##  zip                 2.1.1   2020-08-27 [1] CRAN (R 4.0.2)
##  ztpln             * 0.1.1   2020-07-27 [1] CRAN (R 4.0.2)
## 
## [1] /home/mattocci/R/x86_64-pc-linux-gnu-library/4.0
## [2] /usr/lib/R/library</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dcl-docs/prog/edit/master/%s",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"search": false
});
});
</script>

</body>

</html>
